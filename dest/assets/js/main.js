function toggleModal(){fab.classList.toggle("modalOpen"),newJourneySection.classList.toggle("modalOpen")}function DisplayMessage(e,t){this.displayMessageEl=document.getElementsByClassName("display-message")[0],this.messageEl=document.getElementsByClassName("dm__message")[0],this.actionBTN=document.getElementsByClassName("dm__action")[0],this.dismissBTN=document.getElementsByClassName("dm__dismiss")[0],this._init(e,t)}function Loader(e){this._target=e,this._loader=document.createElement("div"),this._loader.classList.add("spinner"),this._loader.innerHTML='<div class="double-bounce1"></div>\t\t\t\t\t\t\t  <div class="double-bounce2"></div>',this._init()}function Journey(e,t,n,o){this._fromCoordinates=e,this._toCoordinates=t,this._fromName=n?"&fromName="+n:"",this._toName=o?"&toName="+o:"",this._url="https://api.tfl.gov.uk/Journey/JourneyResults/"+this._fromCoordinates+"/to/"+this._toCoordinates+"?nationalSearch=True&timeIs=Departing&journeyPreference=LeastTime&mode=tube&walkingSpeed=Average&cyclePreference=None&alternativeCycle=False&alternativeWalking=False&applyHtmlMarkup=False&useMultiModalCall=False&walkingOptimization=False"+this._fromName+this._toName+"&app_id="+app_id+"&app_key="+app_key,this._init()}var fab=document.getElementsByClassName("fab")[0],newJourneySection=document.getElementsByClassName("new-journey")[0];fab.addEventListener("click",function(){toggleModal()}),DisplayMessage.prototype._open=function(){this.displayMessageEl.classList.add("open")},DisplayMessage.prototype._close=function(){this.displayMessageEl.classList.remove("open")},DisplayMessage.prototype._reset=function(){this.displayMessageEl.classList.remove("success"),this.displayMessageEl.classList.remove("danger"),this.messageEl.innerHTML="",this.actionBTN.style.display="flex"},DisplayMessage.prototype.setupAction=function(e,t){!e|!t&&(this.actionBTN.style.display="none"),this.actionBTN.innerHTML=e,this.actionBTN.addEventListener("click",t)},DisplayMessage.prototype._init=function(e,t){this._reset(),this.displayMessageEl.classList.add(e),this.messageEl.innerHTML=t,this._open();var n=this;this.dismissBTN.addEventListener("click",function(){n._close()})},Loader.prototype._init=function(){this._target.innerHTML="",this._target.appendChild(this._loader)},Loader.prototype.remove=function(){this._target.removeChild(this._loader)};var app_id="1e55ad45",app_key="40c230d6c65288e70be34a738dcc6b91";Journey.prototype._setupData=function(e){for(var t={departure_location:e.journeys[0].legs[0].departurePoint.commonName,arrival_location:e.journeys[0].legs[e.journeys[0].legs.length-1].arrivalPoint.commonName,departure_time:e.journeys[0].startDateTime,journeys:e.journeys},n=0;n<e.journeys.length;n++){t.journeys[n].points=[],t.journeys[n].departure_location,t.journeys[n].arrival_location;for(var o=0;o<e.journeys[n].legs.length;o++)0!=o&&t.journeys[n].points.push(!0),0==o&&(t.journeys[n].departure_location=e.journeys[n].legs[o].departurePoint.commonName),o==e.journeys[n].legs.length-1&&(t.journeys[n].arrival_location=e.journeys[n].legs[o].arrivalPoint.commonName)}return t},Journey.prototype._fetchData=function(){return fetch(this._url).then(function(e){return e.json()})["catch"](function(e){console.log("there was an error here")})},Journey.prototype._init=function(){var e=this;new Loader(document.getElementById("journeys")),this._fetchData().then(function(t){return e._setupData(t)}).then(function(e){var t=MyApp.templates.journeys(e);document.getElementById("journeys").innerHTML=t})["catch"](function(e){console.log("caught!",e);var t=new DisplayMessage("danger","Looks like there was an error getting your journey. Please try a different route");t.setupAction(!1)})};var defaultJourney=new Journey("51.5151846554,-0.17553880792","51.52989409,-0.185888819");fetch("/assets/data/stations.json").then(function(e){return e.json()}).then(function(e){var t={stations:e},n=MyApp.templates.stations(t);return document.getElementById("location_from").innerHTML=n,document.getElementById("location_to").innerHTML=n,Promise.resolve()}).then(function(){var e={sortField:{field:"text",direction:"asc"}};$("#location_from").selectize(e),$("#location_to").selectize(e)});var newJourneyForm=document.getElementById("new-journey-form");newJourneyForm.addEventListener("submit",function(e){e.preventDefault();var t=document.getElementById("location_from").value,n=document.getElementById("location_to").value,o=document.querySelector('#location_from option[selected="selected"]').innerHTML,s=document.querySelector('#location_to option[selected="selected"]').innerHTML;new Journey(t,n,o,s),toggleModal()});